# Kurssin penetration-testing-course-2022-spring h2 tehtävät

## Z) OWASP 10 A03 - Injection

-Injection is the 3rd most potent threat in wep application security in 2021.

-In 2017 list, it was the most potent threat.

-Some common injections are SQL, NoSQL, OS command, ORM, LDAP, and EL or OGNL.

-Weak handling of input validation can be mitigated by performing application security testing prior to deployment

-Example of a SQL injection is that an attacker sends malicious SQL query in the form of an extra condition, such as OR 1=1.

-This query will always return true and the attacker has access to the database.

Lähde: https://owasp.org/Top10/A03_2021-Injection/

## A) SELECT * FROM student. Ratkaise SQLZoo:sta: 0 SELECT basics, 2 SELECT from World kohdat 1-4.

0 Select basics oli aika helppo. ![image](https://user-images.githubusercontent.com/81921071/162594836-bfa93f49-115a-4c8f-9f54-bddd591e4333.png)
SQL kyselyt oli kirjoitettu valmiiksi ja niitä täytyi muokata valmiiksi annettujen arvojen mukaisiksi.

![image](https://user-images.githubusercontent.com/81921071/162595036-1591c989-e359-446d-8e56-cfd02b759744.png)

Select from world tehtävissä piti kirjoittaa muutamaan kohtaan itse kysely. Hieman haastavempia mutta ei kuitenkaan liian hankalia.



## B) Ratkaise WebGoatista: A1 Injection (intro).

2 ![image](https://user-images.githubusercontent.com/81921071/162595148-d5a15081-e77b-406f-95a8-67ce0aa27a28.png)

3 ![image](https://user-images.githubusercontent.com/81921071/162595227-4b41e097-8a93-427c-b16a-0b355e3d891e.png)

4 ![image](https://user-images.githubusercontent.com/81921071/162595313-3d5059c3-2ff0-4d28-aaf1-e0f64c940d35.png)

5 ![image](https://user-images.githubusercontent.com/81921071/162595389-8ed127f5-d6ec-40e3-b38e-1e07e7ec602e.png)

9 ![image](https://user-images.githubusercontent.com/81921071/162595442-ca673f23-a97d-4107-977b-7bcb28ede1cb.png)

10 ![image](https://user-images.githubusercontent.com/81921071/162595524-dd828376-1610-41d6-b55b-d1c4c05caa03.png)

11 ![image](https://user-images.githubusercontent.com/81921071/162595604-b0cee48d-7125-4625-9e05-804b7f6c2dca.png)

12 ![image](https://user-images.githubusercontent.com/81921071/162595880-442dc59c-bbc5-4fc6-80a1-367dd8464a86.png)

13 ![image](https://user-images.githubusercontent.com/81921071/162596013-b13f707a-1e3c-433b-b0dd-92e9ec8b3408.png)



Käytin useammassa tehtävässä apunani W3schoolsia: https://www.w3schools.com/sql/default.asp Ja tehtävissä 12 ja 13 jouduin käyttämään webgoatin vinkkejä.


## C) Nyrkkeilysäkki. Asenna Metasploitable 2 samaan verkkoon Kalin kanssa. Katso, ettei haavoittuva Metasploitable 2 näy Internetiin.

Aloitin asennuksen Googlaamalla ohjeet metasploitin asennukseen. Menin vulnhubin sivuille, koska tämä sivu on mainittu myös Teron materiaaleissa. https://www.vulnhub.com/entry/metasploitable-2,29/ latasin tältä sivulta metasploitable-linux-2.0.0.

Loin Virtualboxiin uuden koneen, ja asetin lataamani metasploitable2 tiedoston virtuaalikoneen levyksi. Asetin myös Kalin ja metasploitablen käyttämään host only network tyyppistä adapteria. Varmistin molemmilla koneillä, että niiden IP:t ovat samassa verkossa. Molemmat ovat. Tarkistin myös, pystyvätkö ne yhdistämään ulkopuoliseen internetiin komennolla ping 8.8.8.8. Kali ja metasploitable ilmoittivat, että eivät pysty.

## D) Nauhalle. Nauhoita kaikki konsolissa annetut asiat ja näkyvät tulosteet koko tehtävästä. (esim script)

Käytin terminaalin inputin tallentamiseen scriptiä. Vilkaisin vinkeistä ja katsoin myös Googlen kautta ohjeita. https://www.cloudsavvyit.com/14200/how-to-record-linux-terminal-commands-with-script/ ohjeesta löytyi monia hyödyllisiä lisävalintoja.

## E) Ei kuulu! Ennenkuin aloitat skannaukset, kokeile, ettei Kali pääse nettiin 'ping 8.8.8.8' vastaa "Network is unreachable"

Kokeilin tämän kohdassa C, kun olin vaihtanut network adapterin host only adapteriksi.
![image](https://user-images.githubusercontent.com/81921071/162590094-9b0cf8af-7f7d-45f0-8c83-0adc542e0a1e.png)

## f) Piilosilla. Etsi Metasploitable 2 verkkoskannauksella. Tarkista ensin, että osoitteet ovat uskottavia (ipcalc 10.0.0.1/23). Sitten ping sweep (nmap -sn). Analysoi tulokset, eli selitä, mitä mikäkin asia tulosteessa tarkoittaa. Mitä päättelet eri koneista?

Kokeilin komentoa nmap -sn 192.168.56.101, mikä on metasploitableni osoite. Varmistin osoitteen metasploitable virtuaalikoneelta joten se on uskottava. -sn lippu poistaa porttiskannauksen komennosta. Lähde: nmap -h.snasc

1 Rivi, Starting Nmap 7.92... - aikaleima sille, mihin aikaan skannaus on aloitettu.

2 Rivi, Nmap scan report for... - Nmapin raportti skannauksesta alkaa

3 Rivi, Host is up (0.0064s latency) - Nmap ilmoittaa, että antamassani ip-osoitteessa on linjoilla oleva pääte.

4 Rivi, Nmap done: 1 IP address (1 host up) scanned in 13.03 seconds - Nmapin raportti päättyy, skannattujen osoitteiden määrän ja löydettyjen päätteiden määrän.

## g) Kilo. Porttiskannaa 1000 tavallisinta porttia löydetyistä koneista. Selitä ja analysoi tulokset. Mikä koneista voisi olla Metasploitable 2?

Tajusin tässä vaiheessa, että minun ei pitänyt skannata edellisessä tehtävässä suoraan ip-osoitteella. No, korjataan virhe nyt. Vaihdoin edellisen tehtävän ip-osoitteen ip-osoiteavaruudeksi.

Käytin komentoa nmap --top-ports 1000 192.168.56.0/24. Komento skannaa 1000 yleisintä porttia. Lähde nmap -h.

osoite 192.168.56.101

Not shown: 977 closed ports.

osoite 192.168.56.102

All 1000 scanned ports are in ignored states. Tämä voisi mahdollisesti olla Kali kone ja tuo ylempi osoite voisi olla metasploitable.

## h) Ja tiskiallas. Porttiskannaa Metasploitable 2 perusteellisesti. Selitä ja analysoi tulokset. Selitä kustakin avoimesta portista, mikä palvelu siinä on / mihin se on tarkoitettu, onko se tavallisesti näkyvissä Internetiin ja onko se nykyiaikainen. Voit myös arvioida, onko versio päivitetty.

![image](https://user-images.githubusercontent.com/81921071/162592906-72527dc5-b8cb-4ec1-ac6e-ed82a01a5883.png)

Avoimet portit:

Portti 21 ftp - Portti 21 on oletusportti ftp kirjautumista varten. Porttia 20 käytetään varsinaiseen tiedonsiirtoon. 

Lähde: https://www.lifewire.com/tcp-port-21-818146

Portti 22 ssh - Portti 22 on SSH etäyhteyden oletusportti. Voisin ottaa ssh yhteyden esimerkiksi linuxissa komennolla ssh <ip-osoite> tai Windowsilla käyttämällä pUTTY ohjelmaa.
  
Portti 23 telnet - Telnet on vahentunut etäyhteysprotokolla.
  
Portti 25 smtp - Lyhenteestä voi päätellä, että tämä portti on simple mail transfer protokollaa varten.

Portti 53 domain - DNS palvelun portti. Käytetään nimipalvelun kommunikaatiota varten.
  
Portti 80 http - HTTP kommunikaation oletusportti. Tämän auki oleminen viittaa siihen, että koneella on jonkinlainen internet applikaatio. Versiosta näkyy myös, että tämä applikaatio on Apache 2.2.8.

## i) Ovi jäi auki. Mitä löytyy portista 1524/tcp? Kokeile netcattilla 'nc'.

![image](https://user-images.githubusercontent.com/81921071/162593170-7ed29c4f-7138-46ad-a581-60bbdb9b9313.png)
  
Tällä komennolla pääsin roottina sisään ilman sen kummempia salasanoja. Portin "Status" kenttä oli kätevästi nimetty metasploitable root shell. Pienenä trollauksena sammutin koneen "shutdown 1" komennolla.
  
![image](https://user-images.githubusercontent.com/81921071/162593221-5f1f2396-9d31-43f3-b2a5-a2d50efe38b7.png)
  
## J) Darn Low Security. Etsi Metasploitable 2 weppipalvelin. Tee paikallinen tunnus DVWA Damn Vulnerable Web App -ohjelmaan. Aseta vasemman reunan palkista "DVWA Security" Low.
  
Aiemman tehtävän perusteella päättelin, että metasploitablessa on pystyssä webbiapplikaatio. Avasin metasploitablen ip-osoitteen kalin nettiselaimella ja saavuin DVWA sivulle. Kirjauduin admin - password tunnuksella ja asetin DVWA securityn low tasolle.
 
## K) Execute! Ratkaise DVWA "Command Excution". ("DVWA Security" on paras olla "Low")
  
DVWA applikaatiossa on kaikenlaisia web applikaation haavoittuvaisuuksia. Niitä voi testata täysin vapaasti. Tehtävässä haluttiin testata command execution haavoittuvuutta.
  
View source napilla pystyn katsomaan applikaation lähdekoodia. Sieltä näin, että applikaatioon syötetty data on täysin validoimatonta. Voin käyttää esimerkiksi && operaattoria ajaakseni omia komentojani lähdekoodin komentojen lisäksi. Tässä pystyisi varmasti laajentamaan käyttöoikeuksiaan, mutta tämän hetkinen taitoni ei riitä siihen ja kotitehtävän palautusaika tulee vastaan.





















